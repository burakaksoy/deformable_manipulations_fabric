<?xml version="1.0"?>
<launch>
<!-- LAUNCH FILE FOR THREE FOLLOWER PARTICLES IN FABRIC -->

<!-- FABRIC Default parameter file location -->
<arg name="fabric_simulator_config"              
        default="$(find deformable_manipulations_fabric)/config/fabric_simulator.yaml"/>
<arg name="fabric_simulator_subs_config"              
        default="$(find deformable_manipulations_fabric)/config/fabric_simulator_subs_multi.yaml"/>


<arg name="fabric_to_polyhedron_distance_config" 
        default="$(find deformable_manipulations_fabric)/config/fabric_to_polyhedron_distance_cube.yaml"/>

<!-- Change below argument values to match with the yaml files -->
<arg name="fabric_points_topic_name" 
        default="fabric_points"/>

<arg name="custom_static_particles_odom_topic_prefix" 
        default="odom_particle_"/>

<arg name="odom_follower_particle_topic_prefix" 
        default="odom_follower_"/>

<arg name="fabric_node_console_logs" 
        default="log"/>

<arg name="follower_1_id" default="14"/>
<arg name="follower_2_id" default="210"/>
<arg name="follower_3_id" default="224"/>

<!-- Load GLOBAL parameters into global namespace -->
<include file="$(find deformable_manipulations_fabric)/launch/load_parameters.launch">
    <arg name="namespace" value="" />
    <arg name="fabric_simulator_config" value="$(arg fabric_simulator_config)" />
    <arg name="fabric_simulator_subs_config" value="$(arg fabric_simulator_subs_config)" />
</include>


<!-- REAL Fabric Representative Simulation -->
<group>
    <arg name="simulation_name" value="fabric_simulator" />
    <arg name="distance_publisher_name" value="fabric_to_polyhedron_distance" />

    <!-- Load parameters into fabric_simulator's private namespace -->
    <include file="$(find deformable_manipulations_fabric)/launch/load_parameters.launch">
        <arg name="namespace" value="$(arg simulation_name)" />
        <arg name="fabric_simulator_config" value="$(arg fabric_simulator_config)" />
        <arg name="fabric_simulator_subs_config" value="$(arg fabric_simulator_subs_config)" />
    </include>

    <!-- Simulation -->
    <node type="fabric_simulator_node" name="$(arg simulation_name)" pkg="fabric_simulator" output="$(arg fabric_node_console_logs)">
        <rosparam param="point_marker_scale"                        subst_value="true">0.01</rosparam>

        <rosparam param="point_marker_color_r"                      subst_value="true">0.0</rosparam>
        <rosparam param="point_marker_color_g"                      subst_value="true">0.0</rosparam>
        <rosparam param="point_marker_color_b"                      subst_value="true">0.0</rosparam>
        <rosparam param="point_marker_color_a"                      subst_value="true">0.5</rosparam>

        <rosparam param="line_marker_scale_multiplier"              subst_value="true">1.0</rosparam>

        <rosparam param="line_marker_color_r"                       subst_value="true">0.2</rosparam>
        <rosparam param="line_marker_color_g"                       subst_value="true">1.0</rosparam>
        <rosparam param="line_marker_color_b"                       subst_value="true">0.2</rosparam>
        <rosparam param="line_marker_color_a"                       subst_value="true">0.0</rosparam>

        <rosparam param="mesh_marker_color_r"                       subst_value="true">0.1</rosparam>
        <rosparam param="mesh_marker_color_g"                       subst_value="true">1.0</rosparam>
        <rosparam param="mesh_marker_color_b"                       subst_value="true">0.1</rosparam>
        <rosparam param="mesh_marker_color_a"                       subst_value="true">0.5</rosparam>
    </node>

    <!-- Launch the Distance Publisher between the Fabric and the specified Polyhedron -->
    <node type="fabric_to_polyhedron_distance.py" name="$(arg distance_publisher_name)" pkg="deformable_manipulations_fabric" output="screen">
        <rosparam command="load" file="$(arg fabric_to_polyhedron_distance_config)" subst_value="true" />
        <rosparam param="fabric_marker_topic_name"                   subst_value="true">/$(arg fabric_points_topic_name)</rosparam>
        <rosparam param="pub_distance_topic_name"                    subst_value="true">/min_distance</rosparam>
        <rosparam param="viz_polyhedron_topic_name"                  subst_value="true">/polyhedron</rosparam>
        <rosparam param="viz_min_distance_line_topic_name"           subst_value="true">/min_distance_line_marker</rosparam>
        <rosparam param="viz_min_distance_line_color_rgba"           subst_value="true">[0.5, 0.5, 0.5, 0.5]</rosparam>
        <rosparam param="polyhedron_publish"                         subst_value="true">True</rosparam>
    </node>

</group>

<!-- Perturbation publisher for each follower particle -->
<node type="perturbation_publisher.py" name="perturbation_publisher" pkg="deformable_manipulations_fabric" output="screen">
    <rosparam param="fabric_marker_topic_name"                   subst_value="true">/$(arg fabric_points_topic_name)</rosparam>
    <rosparam param="pub_odom_topic_prefix"                      subst_value="true">$(arg odom_follower_particle_topic_prefix)</rosparam>
</node>

<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

<!-- Particle $(arg follower_1_id) -->
<group>
    <!-- x -->
    <group>
        <arg name="particle_id" value="$(arg follower_1_id)" />
        <arg name="axis" value="x" />
        
        <arg name="simulation_name_prefix" value="fabric_simulator_" />
        <arg name="distance_publisher_name_prefix" value="fabric_to_polyhedron_distance_" />
        
        <arg name="axis_str" value="" if="$(eval arg('axis') == '')" />
        <arg name="axis_str" value="_$(arg axis)" unless="$(eval arg('axis') == '')" />

        <arg name="simulation_name" value="$(arg simulation_name_prefix)$(arg particle_id)$(arg axis_str)" />
        <arg name="distance_publisher_name" value="$(arg distance_publisher_name_prefix)$(arg particle_id)$(arg axis_str)" />

        <!-- Load parameters into fabric_simulator's private namespace -->
        <include file="$(find deformable_manipulations_fabric)/launch/load_parameters.launch">
            <arg name="namespace" value="$(arg simulation_name)" />
            <arg name="fabric_simulator_config" value="$(arg fabric_simulator_config)" />
            <arg name="fabric_simulator_subs_config" value="$(arg fabric_simulator_subs_config)" />
        </include>

        <!-- Simulation -->
        <node type="fabric_simulator_node" name="$(arg simulation_name)" pkg="fabric_simulator" output="$(arg fabric_node_console_logs)">        
            <remap from="/$(arg custom_static_particles_odom_topic_prefix)$(arg particle_id)" 
                to="/$(arg odom_follower_particle_topic_prefix)$(arg particle_id)$(arg axis_str)"/>
            <remap from="/$(arg fabric_points_topic_name)" 
                to="/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)"/>

            <rosparam param="point_marker_scale"                        subst_value="true">0.005</rosparam>
            
            <rosparam param="point_marker_color_r"                      subst_value="true">1.0</rosparam>
            <rosparam param="point_marker_color_g"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_b"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_a"                      subst_value="true">0.2</rosparam>

            <rosparam param="line_marker_scale_multiplier"              subst_value="true">1</rosparam>

            <rosparam param="line_marker_color_r"                       subst_value="true">1.0</rosparam>
            <rosparam param="line_marker_color_g"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_b"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_a"                       subst_value="true">0.0</rosparam>

            <rosparam param="mesh_marker_color_r"                       subst_value="true">1.0</rosparam>
            <rosparam param="mesh_marker_color_g"                       subst_value="true">0.0</rosparam>
            <rosparam param="mesh_marker_color_b"                       subst_value="true">0.0</rosparam>
            <rosparam param="mesh_marker_color_a"                       subst_value="true">0.2</rosparam>

        </node>

        <!-- Launch the Distance Publisher between the Fabric and the specified Polyhedron  -->
        <node type="fabric_to_polyhedron_distance.py" name="$(arg distance_publisher_name)" pkg="deformable_manipulations_fabric" output="screen">
            <rosparam command="load" file="$(arg fabric_to_polyhedron_distance_config)" subst_value="true" />
            <rosparam param="fabric_marker_topic_name"                   subst_value="true">/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="pub_distance_topic_name"                    subst_value="true">/min_distance_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_polyhedron_topic_name"                  subst_value="true">/polyhedron_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_topic_name"           subst_value="true">/min_distance_line_marker_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_color_rgba"           subst_value="true">[1.0, 0.0, 0.0, 1.0]</rosparam>
            <rosparam param="polyhedron_publish"                         subst_value="true">False</rosparam>
        </node>
    </group>
    <!-- y -->
    <group>
        <arg name="particle_id" value="$(arg follower_1_id)" />
        <arg name="axis" value="y" />
        
        <arg name="simulation_name_prefix" value="fabric_simulator_" />
        <arg name="distance_publisher_name_prefix" value="fabric_to_polyhedron_distance_" />
        
        <arg name="axis_str" value="" if="$(eval arg('axis') == '')" />
        <arg name="axis_str" value="_$(arg axis)" unless="$(eval arg('axis') == '')" />

        <arg name="simulation_name" value="$(arg simulation_name_prefix)$(arg particle_id)$(arg axis_str)" />
        <arg name="distance_publisher_name" value="$(arg distance_publisher_name_prefix)$(arg particle_id)$(arg axis_str)" />

        <!-- Load parameters into fabric_simulator's private namespace -->
        <include file="$(find deformable_manipulations_fabric)/launch/load_parameters.launch">
            <arg name="namespace" value="$(arg simulation_name)" />
            <arg name="fabric_simulator_config" value="$(arg fabric_simulator_config)" />
            <arg name="fabric_simulator_subs_config" value="$(arg fabric_simulator_subs_config)" />
        </include>

        <!-- Simulation -->
        <node type="fabric_simulator_node" name="$(arg simulation_name)" pkg="fabric_simulator" output="$(arg fabric_node_console_logs)">        
            <remap from="/$(arg custom_static_particles_odom_topic_prefix)$(arg particle_id)" 
                to="/$(arg odom_follower_particle_topic_prefix)$(arg particle_id)$(arg axis_str)"/>
            <remap from="/$(arg fabric_points_topic_name)" 
                to="/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)"/>

            <rosparam param="point_marker_scale"                        subst_value="true">0.005</rosparam>
            
            <rosparam param="point_marker_color_r"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_g"                      subst_value="true">0.5</rosparam>
            <rosparam param="point_marker_color_b"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_a"                      subst_value="true">0.2</rosparam>

            <rosparam param="line_marker_scale_multiplier"              subst_value="true">1</rosparam>

            <rosparam param="line_marker_color_r"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_g"                       subst_value="true">0.5</rosparam>
            <rosparam param="line_marker_color_b"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_a"                       subst_value="true">0.0</rosparam>

            <rosparam param="mesh_marker_color_r"                       subst_value="true">0.0</rosparam>
            <rosparam param="mesh_marker_color_g"                       subst_value="true">0.5</rosparam>
            <rosparam param="mesh_marker_color_b"                       subst_value="true">0.0</rosparam>
            <rosparam param="mesh_marker_color_a"                       subst_value="true">0.2</rosparam>

        </node>

        <!-- Launch the Distance Publisher between the Fabric and the specified Polyhedron -->
        <node type="fabric_to_polyhedron_distance.py" name="$(arg distance_publisher_name)" pkg="deformable_manipulations_fabric" output="screen">
            <rosparam command="load" file="$(arg fabric_to_polyhedron_distance_config)" subst_value="true" />
            <rosparam param="fabric_marker_topic_name"                   subst_value="true">/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="pub_distance_topic_name"                    subst_value="true">/min_distance_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_polyhedron_topic_name"                  subst_value="true">/polyhedron_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_topic_name"           subst_value="true">/min_distance_line_marker_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_color_rgba"           subst_value="true">[0.0, 1.0, 0.0, 1.0]</rosparam>
            <rosparam param="polyhedron_publish"                         subst_value="true">False</rosparam>
        </node>
    </group>
    <!-- z -->
    <group>
        <arg name="particle_id" value="$(arg follower_1_id)" />
        <arg name="axis" value="z" />
        
        <arg name="simulation_name_prefix" value="fabric_simulator_" />
        <arg name="distance_publisher_name_prefix" value="fabric_to_polyhedron_distance_" />
        
        <arg name="axis_str" value="" if="$(eval arg('axis') == '')" />
        <arg name="axis_str" value="_$(arg axis)" unless="$(eval arg('axis') == '')" />

        <arg name="simulation_name" value="$(arg simulation_name_prefix)$(arg particle_id)$(arg axis_str)" />
        <arg name="distance_publisher_name" value="$(arg distance_publisher_name_prefix)$(arg particle_id)$(arg axis_str)" />

        <!-- Load parameters into fabric_simulator's private namespace -->
        <include file="$(find deformable_manipulations_fabric)/launch/load_parameters.launch">
            <arg name="namespace" value="$(arg simulation_name)" />
            <arg name="fabric_simulator_config" value="$(arg fabric_simulator_config)" />
            <arg name="fabric_simulator_subs_config" value="$(arg fabric_simulator_subs_config)" />
        </include>

        <!-- Simulation -->
        <node type="fabric_simulator_node" name="$(arg simulation_name)" pkg="fabric_simulator" output="$(arg fabric_node_console_logs)">        
            <remap from="/$(arg custom_static_particles_odom_topic_prefix)$(arg particle_id)" 
                to="/$(arg odom_follower_particle_topic_prefix)$(arg particle_id)$(arg axis_str)"/>
            <remap from="/$(arg fabric_points_topic_name)" 
                to="/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)"/>

            <rosparam param="point_marker_scale"                        subst_value="true">0.005</rosparam>
            
            <rosparam param="point_marker_color_r"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_g"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_b"                      subst_value="true">1.0</rosparam>
            <rosparam param="point_marker_color_a"                      subst_value="true">0.2</rosparam>
            
            <rosparam param="line_marker_scale_multiplier"              subst_value="true">1</rosparam>

            <rosparam param="line_marker_color_r"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_g"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_b"                       subst_value="true">1.0</rosparam>
            <rosparam param="line_marker_color_a"                       subst_value="true">0.0</rosparam>

            <rosparam param="mesh_marker_color_r"                       subst_value="true">0.0</rosparam>
            <rosparam param="mesh_marker_color_g"                       subst_value="true">1.0</rosparam>
            <rosparam param="mesh_marker_color_b"                       subst_value="true">1.0</rosparam>
            <rosparam param="mesh_marker_color_a"                       subst_value="true">0.2</rosparam>

        </node>

        <!-- Launch the Distance Publisher between the Fabric and the specified Polyhedron -->
        <node type="fabric_to_polyhedron_distance.py" name="$(arg distance_publisher_name)" pkg="deformable_manipulations_fabric" output="screen">
            <rosparam command="load" file="$(arg fabric_to_polyhedron_distance_config)" subst_value="true" />
            <rosparam param="fabric_marker_topic_name"                   subst_value="true">/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="pub_distance_topic_name"                    subst_value="true">/min_distance_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_polyhedron_topic_name"                  subst_value="true">/polyhedron_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_topic_name"           subst_value="true">/min_distance_line_marker_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_color_rgba"           subst_value="true">[0.0, 0.0, 1.0, 1.0]</rosparam>
            <rosparam param="polyhedron_publish"                         subst_value="true">False</rosparam>
        </node>
    </group>

    <!-- CONTROLLER -->
    <group>
        <arg name="particle_id" value="$(arg follower_1_id)" />

        <arg name="controller_name_prefix" value="fabric_velocity_controller_" />

        <node type="fabric_velocity_controller_safe.py" name="$(arg controller_name_prefix)$(arg particle_id)" pkg="deformable_manipulations_fabric" output="log"> 
            <rosparam param="id"                                              subst_value="true">$(arg particle_id)</rosparam>
            <rosparam param="fabric_points_topic_name"                           subst_value="true">/$(arg fabric_points_topic_name)</rosparam>
            <rosparam param="min_distance_topic_prefix"                       subst_value="true">/min_distance</rosparam>
            <rosparam param="kp"                                              subst_value="true">[10.0,10.0,10.0]</rosparam>
            <rosparam param="kd"                                              subst_value="true">[0.0,0.0,0.0]</rosparam>
        </node>
    </group>


</group>
<!-- Particle $(arg follower_2_id) -->
<group>
    <!-- x -->
    <group>
        <arg name="particle_id" value="$(arg follower_2_id)" />
        <arg name="axis" value="x" />
        
        <arg name="simulation_name_prefix" value="fabric_simulator_" />
        <arg name="distance_publisher_name_prefix" value="fabric_to_polyhedron_distance_" />
        
        <arg name="axis_str" value="" if="$(eval arg('axis') == '')" />
        <arg name="axis_str" value="_$(arg axis)" unless="$(eval arg('axis') == '')" />

        <arg name="simulation_name" value="$(arg simulation_name_prefix)$(arg particle_id)$(arg axis_str)" />
        <arg name="distance_publisher_name" value="$(arg distance_publisher_name_prefix)$(arg particle_id)$(arg axis_str)" />

        <!-- Load parameters into fabric_simulator's private namespace -->
        <include file="$(find deformable_manipulations_fabric)/launch/load_parameters.launch">
            <arg name="namespace" value="$(arg simulation_name)" />
            <arg name="fabric_simulator_config" value="$(arg fabric_simulator_config)" />
            <arg name="fabric_simulator_subs_config" value="$(arg fabric_simulator_subs_config)" />
        </include>

        <!-- Simulation -->
        <node type="fabric_simulator_node" name="$(arg simulation_name)" pkg="fabric_simulator" output="$(arg fabric_node_console_logs)">        
            <remap from="/$(arg custom_static_particles_odom_topic_prefix)$(arg particle_id)" 
                to="/$(arg odom_follower_particle_topic_prefix)$(arg particle_id)$(arg axis_str)"/>
            <remap from="/$(arg fabric_points_topic_name)" 
                to="/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)"/>

            <rosparam param="point_marker_scale"                        subst_value="true">0.005</rosparam>
            
            <rosparam param="point_marker_color_r"                      subst_value="true">1.0</rosparam>
            <rosparam param="point_marker_color_g"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_b"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_a"                      subst_value="true">0.6</rosparam>

            <rosparam param="line_marker_scale_multiplier"              subst_value="true">6</rosparam>

            <rosparam param="line_marker_color_r"                       subst_value="true">1.0</rosparam>
            <rosparam param="line_marker_color_g"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_b"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_a"                       subst_value="true">0.6</rosparam>

            <rosparam param="mesh_marker_color_r"                       subst_value="true">1.0</rosparam>
            <rosparam param="mesh_marker_color_g"                       subst_value="true">0.0</rosparam>
            <rosparam param="mesh_marker_color_b"                       subst_value="true">0.0</rosparam>
            <rosparam param="mesh_marker_color_a"                       subst_value="true">0.6</rosparam>

        </node>

        <!-- Launch the Distance Publisher between the Fabric and the specified Polyhedron  -->
        <node type="fabric_to_polyhedron_distance.py" name="$(arg distance_publisher_name)" pkg="deformable_manipulations_fabric" output="screen">
            <rosparam command="load" file="$(arg fabric_to_polyhedron_distance_config)" subst_value="true" />
            <rosparam param="fabric_marker_topic_name"                   subst_value="true">/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="pub_distance_topic_name"                    subst_value="true">/min_distance_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_polyhedron_topic_name"                  subst_value="true">/polyhedron_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_topic_name"           subst_value="true">/min_distance_line_marker_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_color_rgba"           subst_value="true">[1.0, 0.0, 0.0, 1.0]</rosparam>
            <rosparam param="polyhedron_publish"                         subst_value="true">False</rosparam>
        </node>
    </group>
    <!-- y -->
    <group>
        <arg name="particle_id" value="$(arg follower_2_id)" />
        <arg name="axis" value="y" />
        
        <arg name="simulation_name_prefix" value="fabric_simulator_" />
        <arg name="distance_publisher_name_prefix" value="fabric_to_polyhedron_distance_" />
        
        <arg name="axis_str" value="" if="$(eval arg('axis') == '')" />
        <arg name="axis_str" value="_$(arg axis)" unless="$(eval arg('axis') == '')" />

        <arg name="simulation_name" value="$(arg simulation_name_prefix)$(arg particle_id)$(arg axis_str)" />
        <arg name="distance_publisher_name" value="$(arg distance_publisher_name_prefix)$(arg particle_id)$(arg axis_str)" />

        <!-- Load parameters into fabric_simulator's private namespace -->
        <include file="$(find deformable_manipulations_fabric)/launch/load_parameters.launch">
            <arg name="namespace" value="$(arg simulation_name)" />
            <arg name="fabric_simulator_config" value="$(arg fabric_simulator_config)" />
            <arg name="fabric_simulator_subs_config" value="$(arg fabric_simulator_subs_config)" />
        </include>

        <!-- Simulation -->
        <node type="fabric_simulator_node" name="$(arg simulation_name)" pkg="fabric_simulator" output="$(arg fabric_node_console_logs)">        
            <remap from="/$(arg custom_static_particles_odom_topic_prefix)$(arg particle_id)" 
                to="/$(arg odom_follower_particle_topic_prefix)$(arg particle_id)$(arg axis_str)"/>
            <remap from="/$(arg fabric_points_topic_name)" 
                to="/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)"/>

            <rosparam param="point_marker_scale"                        subst_value="true">0.005</rosparam>
            
            <rosparam param="point_marker_color_r"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_g"                      subst_value="true">1.0</rosparam>
            <rosparam param="point_marker_color_b"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_a"                      subst_value="true">0.6</rosparam>

            <rosparam param="line_marker_scale_multiplier"              subst_value="true">6</rosparam>

            <rosparam param="line_marker_color_r"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_g"                       subst_value="true">1.0</rosparam>
            <rosparam param="line_marker_color_b"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_a"                       subst_value="true">0.6</rosparam>

            <rosparam param="mesh_marker_color_r"                       subst_value="true">0.0</rosparam>
            <rosparam param="mesh_marker_color_g"                       subst_value="true">1.0</rosparam>
            <rosparam param="mesh_marker_color_b"                       subst_value="true">0.0</rosparam>
            <rosparam param="mesh_marker_color_a"                       subst_value="true">0.6</rosparam>

        </node>

        <!-- Launch the Distance Publisher between the Fabric and the specified Polyhedron -->
        <node type="fabric_to_polyhedron_distance.py" name="$(arg distance_publisher_name)" pkg="deformable_manipulations_fabric" output="screen">
            <rosparam command="load" file="$(arg fabric_to_polyhedron_distance_config)" subst_value="true" />
            <rosparam param="fabric_marker_topic_name"                   subst_value="true">/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="pub_distance_topic_name"                    subst_value="true">/min_distance_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_polyhedron_topic_name"                  subst_value="true">/polyhedron_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_topic_name"           subst_value="true">/min_distance_line_marker_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_color_rgba"           subst_value="true">[0.0, 1.0, 0.0, 1.0]</rosparam>
            <rosparam param="polyhedron_publish"                         subst_value="true">False</rosparam>
        </node>
    </group>
    <!-- z -->
    <group>
        <arg name="particle_id" value="$(arg follower_2_id)" />
        <arg name="axis" value="z" />
        
        <arg name="simulation_name_prefix" value="fabric_simulator_" />
        <arg name="distance_publisher_name_prefix" value="fabric_to_polyhedron_distance_" />
        
        <arg name="axis_str" value="" if="$(eval arg('axis') == '')" />
        <arg name="axis_str" value="_$(arg axis)" unless="$(eval arg('axis') == '')" />

        <arg name="simulation_name" value="$(arg simulation_name_prefix)$(arg particle_id)$(arg axis_str)" />
        <arg name="distance_publisher_name" value="$(arg distance_publisher_name_prefix)$(arg particle_id)$(arg axis_str)" />

        <!-- Load parameters into fabric_simulator's private namespace -->
        <include file="$(find deformable_manipulations_fabric)/launch/load_parameters.launch">
            <arg name="namespace" value="$(arg simulation_name)" />
            <arg name="fabric_simulator_config" value="$(arg fabric_simulator_config)" />
            <arg name="fabric_simulator_subs_config" value="$(arg fabric_simulator_subs_config)" />
        </include>

        <!-- Simulation -->
        <node type="fabric_simulator_node" name="$(arg simulation_name)" pkg="fabric_simulator" output="$(arg fabric_node_console_logs)">        
            <remap from="/$(arg custom_static_particles_odom_topic_prefix)$(arg particle_id)" 
                to="/$(arg odom_follower_particle_topic_prefix)$(arg particle_id)$(arg axis_str)"/>
            <remap from="/$(arg fabric_points_topic_name)" 
                to="/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)"/>

            <rosparam param="point_marker_scale"                        subst_value="true">0.005</rosparam>
            
            <rosparam param="point_marker_color_r"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_g"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_b"                      subst_value="true">1.0</rosparam>
            <rosparam param="point_marker_color_a"                      subst_value="true">0.6</rosparam>
            
            <rosparam param="line_marker_scale_multiplier"              subst_value="true">6</rosparam>

            <rosparam param="line_marker_color_r"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_g"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_b"                       subst_value="true">1.0</rosparam>
            <rosparam param="line_marker_color_a"                       subst_value="true">0.6</rosparam>

            <rosparam param="mesh_marker_color_r"                       subst_value="true">0.0</rosparam>
            <rosparam param="mesh_marker_color_g"                       subst_value="true">0.0</rosparam>
            <rosparam param="mesh_marker_color_b"                       subst_value="true">1.0</rosparam>
            <rosparam param="mesh_marker_color_a"                       subst_value="true">0.6</rosparam>

        </node>

        <!-- Launch the Distance Publisher between the Fabric and the specified Polyhedron -->
        <node type="fabric_to_polyhedron_distance.py" name="$(arg distance_publisher_name)" pkg="deformable_manipulations_fabric" output="screen">
            <rosparam command="load" file="$(arg fabric_to_polyhedron_distance_config)" subst_value="true" />
            <rosparam param="fabric_marker_topic_name"                   subst_value="true">/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="pub_distance_topic_name"                    subst_value="true">/min_distance_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_polyhedron_topic_name"                  subst_value="true">/polyhedron_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_topic_name"           subst_value="true">/min_distance_line_marker_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_color_rgba"           subst_value="true">[0.0, 0.0, 1.0, 1.0]</rosparam>
            <rosparam param="polyhedron_publish"                         subst_value="true">False</rosparam>
        </node>
    </group>

    <!-- CONTROLLER -->
    <group>
        <arg name="particle_id" value="$(arg follower_2_id)" />

        <arg name="controller_name_prefix" value="fabric_velocity_controller_" />

        <node type="fabric_velocity_controller_safe.py" name="$(arg controller_name_prefix)$(arg particle_id)" pkg="deformable_manipulations_fabric" output="log"> 
            <rosparam param="id"                                              subst_value="true">$(arg particle_id)</rosparam>
            <rosparam param="fabric_points_topic_name"                           subst_value="true">/$(arg fabric_points_topic_name)</rosparam>
            <rosparam param="min_distance_topic_prefix"                       subst_value="true">/min_distance</rosparam>
            <rosparam param="kp"                                              subst_value="true">[10.0,10.0,10.0]</rosparam>
            <rosparam param="kd"                                              subst_value="true">[0.0,0.0,0.0]</rosparam>
        </node>
    </group>


</group>
<!-- Particle $(arg follower_3_id) -->
<group>
    <!-- x -->
    <group>
        <arg name="particle_id" value="$(arg follower_3_id)" />
        <arg name="axis" value="x" />
        
        <arg name="simulation_name_prefix" value="fabric_simulator_" />
        <arg name="distance_publisher_name_prefix" value="fabric_to_polyhedron_distance_" />
        
        <arg name="axis_str" value="" if="$(eval arg('axis') == '')" />
        <arg name="axis_str" value="_$(arg axis)" unless="$(eval arg('axis') == '')" />

        <arg name="simulation_name" value="$(arg simulation_name_prefix)$(arg particle_id)$(arg axis_str)" />
        <arg name="distance_publisher_name" value="$(arg distance_publisher_name_prefix)$(arg particle_id)$(arg axis_str)" />

        <!-- Load parameters into fabric_simulator's private namespace -->
        <include file="$(find deformable_manipulations_fabric)/launch/load_parameters.launch">
            <arg name="namespace" value="$(arg simulation_name)" />
            <arg name="fabric_simulator_config" value="$(arg fabric_simulator_config)" />
            <arg name="fabric_simulator_subs_config" value="$(arg fabric_simulator_subs_config)" />
        </include>

        <!-- Simulation -->
        <node type="fabric_simulator_node" name="$(arg simulation_name)" pkg="fabric_simulator" output="$(arg fabric_node_console_logs)">        
            <remap from="/$(arg custom_static_particles_odom_topic_prefix)$(arg particle_id)" 
                to="/$(arg odom_follower_particle_topic_prefix)$(arg particle_id)$(arg axis_str)"/>
            <remap from="/$(arg fabric_points_topic_name)" 
                to="/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)"/>

            <rosparam param="point_marker_scale"                        subst_value="true">0.005</rosparam>
            
            <rosparam param="point_marker_color_r"                      subst_value="true">1.0</rosparam>
            <rosparam param="point_marker_color_g"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_b"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_a"                      subst_value="true">0.6</rosparam>

            <rosparam param="line_marker_scale_multiplier"              subst_value="true">6</rosparam>

            <rosparam param="line_marker_color_r"                       subst_value="true">1.0</rosparam>
            <rosparam param="line_marker_color_g"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_b"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_a"                       subst_value="true">0.6</rosparam>

            <rosparam param="mesh_marker_color_r"                       subst_value="true">1.0</rosparam>
            <rosparam param="mesh_marker_color_g"                       subst_value="true">0.0</rosparam>
            <rosparam param="mesh_marker_color_b"                       subst_value="true">0.0</rosparam>
            <rosparam param="mesh_marker_color_a"                       subst_value="true">0.6</rosparam>

        </node>

        <!-- Launch the Distance Publisher between the Fabric and the specified Polyhedron  -->
        <node type="fabric_to_polyhedron_distance.py" name="$(arg distance_publisher_name)" pkg="deformable_manipulations_fabric" output="screen">
            <rosparam command="load" file="$(arg fabric_to_polyhedron_distance_config)" subst_value="true" />
            <rosparam param="fabric_marker_topic_name"                   subst_value="true">/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="pub_distance_topic_name"                    subst_value="true">/min_distance_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_polyhedron_topic_name"                  subst_value="true">/polyhedron_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_topic_name"           subst_value="true">/min_distance_line_marker_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_color_rgba"           subst_value="true">[1.0, 0.0, 0.0, 1.0]</rosparam>
            <rosparam param="polyhedron_publish"                         subst_value="true">False</rosparam>
        </node>
    </group>
    <!-- y -->
    <group>
        <arg name="particle_id" value="$(arg follower_3_id)" />
        <arg name="axis" value="y" />
        
        <arg name="simulation_name_prefix" value="fabric_simulator_" />
        <arg name="distance_publisher_name_prefix" value="fabric_to_polyhedron_distance_" />
        
        <arg name="axis_str" value="" if="$(eval arg('axis') == '')" />
        <arg name="axis_str" value="_$(arg axis)" unless="$(eval arg('axis') == '')" />

        <arg name="simulation_name" value="$(arg simulation_name_prefix)$(arg particle_id)$(arg axis_str)" />
        <arg name="distance_publisher_name" value="$(arg distance_publisher_name_prefix)$(arg particle_id)$(arg axis_str)" />

        <!-- Load parameters into fabric_simulator's private namespace -->
        <include file="$(find deformable_manipulations_fabric)/launch/load_parameters.launch">
            <arg name="namespace" value="$(arg simulation_name)" />
            <arg name="fabric_simulator_config" value="$(arg fabric_simulator_config)" />
            <arg name="fabric_simulator_subs_config" value="$(arg fabric_simulator_subs_config)" />
        </include>

        <!-- Simulation -->
        <node type="fabric_simulator_node" name="$(arg simulation_name)" pkg="fabric_simulator" output="$(arg fabric_node_console_logs)">        
            <remap from="/$(arg custom_static_particles_odom_topic_prefix)$(arg particle_id)" 
                to="/$(arg odom_follower_particle_topic_prefix)$(arg particle_id)$(arg axis_str)"/>
            <remap from="/$(arg fabric_points_topic_name)" 
                to="/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)"/>

            <rosparam param="point_marker_scale"                        subst_value="true">0.005</rosparam>
            
            <rosparam param="point_marker_color_r"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_g"                      subst_value="true">1.0</rosparam>
            <rosparam param="point_marker_color_b"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_a"                      subst_value="true">0.6</rosparam>

            <rosparam param="line_marker_scale_multiplier"              subst_value="true">6</rosparam>

            <rosparam param="line_marker_color_r"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_g"                       subst_value="true">1.0</rosparam>
            <rosparam param="line_marker_color_b"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_a"                       subst_value="true">0.6</rosparam>

            <rosparam param="mesh_marker_color_r"                       subst_value="true">0.0</rosparam>
            <rosparam param="mesh_marker_color_g"                       subst_value="true">1.0</rosparam>
            <rosparam param="mesh_marker_color_b"                       subst_value="true">0.0</rosparam>
            <rosparam param="mesh_marker_color_a"                       subst_value="true">0.6</rosparam>

        </node>

        <!-- Launch the Distance Publisher between the Fabric and the specified Polyhedron -->
        <node type="fabric_to_polyhedron_distance.py" name="$(arg distance_publisher_name)" pkg="deformable_manipulations_fabric" output="screen">
            <rosparam command="load" file="$(arg fabric_to_polyhedron_distance_config)" subst_value="true" />
            <rosparam param="fabric_marker_topic_name"                   subst_value="true">/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="pub_distance_topic_name"                    subst_value="true">/min_distance_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_polyhedron_topic_name"                  subst_value="true">/polyhedron_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_topic_name"           subst_value="true">/min_distance_line_marker_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_color_rgba"           subst_value="true">[0.0, 1.0, 0.0, 1.0]</rosparam>
            <rosparam param="polyhedron_publish"                         subst_value="true">False</rosparam>
        </node>
    </group>
    <!-- z -->
    <group>
        <arg name="particle_id" value="$(arg follower_3_id)" />
        <arg name="axis" value="z" />
        
        <arg name="simulation_name_prefix" value="fabric_simulator_" />
        <arg name="distance_publisher_name_prefix" value="fabric_to_polyhedron_distance_" />
        
        <arg name="axis_str" value="" if="$(eval arg('axis') == '')" />
        <arg name="axis_str" value="_$(arg axis)" unless="$(eval arg('axis') == '')" />

        <arg name="simulation_name" value="$(arg simulation_name_prefix)$(arg particle_id)$(arg axis_str)" />
        <arg name="distance_publisher_name" value="$(arg distance_publisher_name_prefix)$(arg particle_id)$(arg axis_str)" />

        <!-- Load parameters into fabric_simulator's private namespace -->
        <include file="$(find deformable_manipulations_fabric)/launch/load_parameters.launch">
            <arg name="namespace" value="$(arg simulation_name)" />
            <arg name="fabric_simulator_config" value="$(arg fabric_simulator_config)" />
            <arg name="fabric_simulator_subs_config" value="$(arg fabric_simulator_subs_config)" />
        </include>

        <!-- Simulation -->
        <node type="fabric_simulator_node" name="$(arg simulation_name)" pkg="fabric_simulator" output="$(arg fabric_node_console_logs)">        
            <remap from="/$(arg custom_static_particles_odom_topic_prefix)$(arg particle_id)" 
                to="/$(arg odom_follower_particle_topic_prefix)$(arg particle_id)$(arg axis_str)"/>
            <remap from="/$(arg fabric_points_topic_name)" 
                to="/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)"/>

            <rosparam param="point_marker_scale"                        subst_value="true">0.005</rosparam>
            
            <rosparam param="point_marker_color_r"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_g"                      subst_value="true">0.0</rosparam>
            <rosparam param="point_marker_color_b"                      subst_value="true">1.0</rosparam>
            <rosparam param="point_marker_color_a"                      subst_value="true">0.6</rosparam>
            
            <rosparam param="line_marker_scale_multiplier"              subst_value="true">6</rosparam>

            <rosparam param="line_marker_color_r"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_g"                       subst_value="true">0.0</rosparam>
            <rosparam param="line_marker_color_b"                       subst_value="true">1.0</rosparam>
            <rosparam param="line_marker_color_a"                       subst_value="true">0.6</rosparam>

            <rosparam param="mesh_marker_color_r"                       subst_value="true">0.0</rosparam>
            <rosparam param="mesh_marker_color_g"                       subst_value="true">0.0</rosparam>
            <rosparam param="mesh_marker_color_b"                       subst_value="true">1.0</rosparam>
            <rosparam param="mesh_marker_color_a"                       subst_value="true">0.6</rosparam>

        </node>

        <!-- Launch the Distance Publisher between the Fabric and the specified Polyhedron -->
        <node type="fabric_to_polyhedron_distance.py" name="$(arg distance_publisher_name)" pkg="deformable_manipulations_fabric" output="screen">
            <rosparam command="load" file="$(arg fabric_to_polyhedron_distance_config)" subst_value="true" />
            <rosparam param="fabric_marker_topic_name"                   subst_value="true">/$(arg fabric_points_topic_name)_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="pub_distance_topic_name"                    subst_value="true">/min_distance_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_polyhedron_topic_name"                  subst_value="true">/polyhedron_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_topic_name"           subst_value="true">/min_distance_line_marker_$(arg particle_id)$(arg axis_str)</rosparam>
            <rosparam param="viz_min_distance_line_color_rgba"           subst_value="true">[0.0, 0.0, 1.0, 1.0]</rosparam>
            <rosparam param="polyhedron_publish"                         subst_value="true">False</rosparam>
        </node>
    </group>

    <!-- CONTROLLER -->
    <group>
        <arg name="particle_id" value="$(arg follower_3_id)" />

        <arg name="controller_name_prefix" value="fabric_velocity_controller_" />

        <node type="fabric_velocity_controller_safe.py" name="$(arg controller_name_prefix)$(arg particle_id)" pkg="deformable_manipulations_fabric" output="log"> 
            <rosparam param="id"                                              subst_value="true">$(arg particle_id)</rosparam>
            <rosparam param="fabric_points_topic_name"                           subst_value="true">/$(arg fabric_points_topic_name)</rosparam>
            <rosparam param="min_distance_topic_prefix"                       subst_value="true">/min_distance</rosparam>
            <rosparam param="kp"                                              subst_value="true">[10.0,10.0,10.0]</rosparam>
            <rosparam param="kd"                                              subst_value="true">[0.0,0.0,0.0]</rosparam>
        </node>
    </group>


</group>

<!-- ++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

<!-- Launch RVIZ  -->
<node type="rviz" name="rviz" pkg="rviz" args="-d $(find deformable_manipulations_fabric)/rviz/fabric_sim_test_2.rviz" output="screen"/>

<!-- SPACE MOUSE -->
<!-- <include file="$(find spacenav_node)/launch/classic.launch"/> -->
<node type="rqt_ez_publisher" name="rqt_ez_publisher" pkg="rqt_ez_publisher" output="log"></node>

<!-- GUI -->
<node type="fake_odom_publisher_gui.py" name="fake_odom_publisher_gui" pkg="deformable_manipulations_fabric" output="screen"></node>

<!-- Trail Printers -->
<group>
    <arg name="particle_id" value="0" />
    <node type="trail_maker.py" name="trail_maker_$(arg particle_id)" pkg="deformable_manipulations_fabric" output="screen">
        <rosparam param="id"                            subst_value="true">$(arg particle_id)</rosparam>

        <rosparam param="trail_marker_array_topic"      subst_value="true">trail_marker_array_$(arg particle_id)</rosparam>
        <rosparam param="odom_topic"                    subst_value="true">$(arg custom_static_particles_odom_topic_prefix)$(arg particle_id)</rosparam>
        <rosparam param="reset_trail_service"           subst_value="true">reset_trail_service_$(arg particle_id)</rosparam>
        
        <rosparam param="header_frame_id"               subst_value="true">map</rosparam>

        <rosparam param="marker_scale"                  subst_value="true">0.01</rosparam>
        <rosparam param="marker_color"                  subst_value="true">{r: 1.0, g: 0.5, b: 0.0, a: 0.6}</rosparam>

        <rosparam param="text_scale"                    subst_value="true">0.15</rosparam>
        <rosparam param="text_color"                    subst_value="true">{r: 0.0, g: 0.0, b: 0.0, a: 0.1}</rosparam>
        <rosparam param="text_offset_xyz"               subst_value="true">{'x': 0.0, 'y': 0.0, 'z': 0.1}</rosparam>

        <rosparam param="sphere_scale"                  subst_value="true">0.11</rosparam>
        <rosparam param="sphere_color"                  subst_value="true">{r: 1.0, g: 0.5, b: 0.0, a: 0.8}</rosparam>
    </node>
</group>

<group>
    <arg name="particle_id" value="14" />
    <node type="trail_maker.py" name="trail_maker_$(arg particle_id)" pkg="deformable_manipulations_fabric" output="screen">
        <rosparam param="id"                            subst_value="true">$(arg particle_id)</rosparam>

        <rosparam param="trail_marker_array_topic"      subst_value="true">trail_marker_array_$(arg particle_id)</rosparam>
        <rosparam param="odom_topic"                    subst_value="true">$(arg custom_static_particles_odom_topic_prefix)$(arg particle_id)</rosparam>
        <rosparam param="reset_trail_service"           subst_value="true">reset_trail_service_$(arg particle_id)</rosparam>
        
        <rosparam param="header_frame_id"               subst_value="true">map</rosparam>

        <rosparam param="marker_scale"                  subst_value="true">0.01</rosparam>
        <rosparam param="marker_color"                  subst_value="true">{r: 1.0, g: 0.0, b: 1.0, a: 0.6}</rosparam>

        <rosparam param="text_scale"                  subst_value="true">0.15</rosparam>
        <rosparam param="text_color"                  subst_value="true">{r: 0.0, g: 0.0, b: 0.0, a: 0.5}</rosparam>
        <rosparam param="text_offset_xyz"             subst_value="true">{'x': 0.0, 'y': 0.0, 'z': 0.1}</rosparam>

        <rosparam param="sphere_scale"                  subst_value="true">0.11</rosparam>
        <rosparam param="sphere_color"                  subst_value="true">{r: 1.0, g: 0.0, b: 1.0, a: 0.8}</rosparam>
    </node>
</group>

<group>
    <arg name="particle_id" value="210" />
    <node type="trail_maker.py" name="trail_maker_$(arg particle_id)" pkg="deformable_manipulations_fabric" output="screen">
        <rosparam param="id"                            subst_value="true">$(arg particle_id)</rosparam>

        <rosparam param="trail_marker_array_topic"      subst_value="true">trail_marker_array_$(arg particle_id)</rosparam>
        <rosparam param="odom_topic"                    subst_value="true">$(arg custom_static_particles_odom_topic_prefix)$(arg particle_id)</rosparam>
        <rosparam param="reset_trail_service"           subst_value="true">reset_trail_service_$(arg particle_id)</rosparam>
        
        <rosparam param="header_frame_id"               subst_value="true">map</rosparam>

        <rosparam param="marker_scale"                  subst_value="true">0.01</rosparam>
        <rosparam param="marker_color"                  subst_value="true">{r: 0.5, g: 0.0, b: 0.5, a: 0.6}</rosparam>

        <rosparam param="text_scale"                  subst_value="true">0.15</rosparam>
        <rosparam param="text_color"                  subst_value="true">{r: 0.0, g: 0.0, b: 0.0, a: 0.1}</rosparam>
        <rosparam param="text_offset_xyz"             subst_value="true">{'x': 0.0, 'y': 0.0, 'z': 0.1}</rosparam>

        <rosparam param="sphere_scale"                  subst_value="true">0.11</rosparam>
        <rosparam param="sphere_color"                  subst_value="true">{r: 0.5, g: 0.0, b: 0.5, a: 0.8}</rosparam>
    </node>
</group>

<group>
    <arg name="particle_id" value="224" />
    <node type="trail_maker.py" name="trail_maker_$(arg particle_id)" pkg="deformable_manipulations_fabric" output="screen">
        <rosparam param="id"                            subst_value="true">$(arg particle_id)</rosparam>

        <rosparam param="trail_marker_array_topic"      subst_value="true">trail_marker_array_$(arg particle_id)</rosparam>
        <rosparam param="odom_topic"                    subst_value="true">$(arg custom_static_particles_odom_topic_prefix)$(arg particle_id)</rosparam>
        <rosparam param="reset_trail_service"           subst_value="true">reset_trail_service_$(arg particle_id)</rosparam>
        
        <rosparam param="header_frame_id"               subst_value="true">map</rosparam>

        <rosparam param="marker_scale"                  subst_value="true">0.01</rosparam>
        <rosparam param="marker_color"                  subst_value="true">{r: 0.5, g: 0.0, b: 1.0, a: 0.6}</rosparam>

        <rosparam param="text_scale"                  subst_value="true">0.15</rosparam>
        <rosparam param="text_color"                  subst_value="true">{r: 0.0, g: 0.0, b: 0.0, a: 0.1}</rosparam>
        <rosparam param="text_offset_xyz"             subst_value="true">{'x': 0.0, 'y': 0.0, 'z': 0.1}</rosparam>

        <rosparam param="sphere_scale"                  subst_value="true">0.11</rosparam>
        <rosparam param="sphere_color"                  subst_value="true">{r: 0.5, g: 0.0, b: 1.0, a: 0.8}</rosparam>
    </node>
</group>


</launch>